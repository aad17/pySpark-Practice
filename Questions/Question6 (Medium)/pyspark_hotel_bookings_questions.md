# PySpark Mini Project (Medium Difficulty): Hotel Bookings Analytics

This project uses 3 datasets: `hotels.csv`, `guests.csv`, and `bookings.csv`. Load them using PySpark DataFrames.

## 🧰 Setup
- Load all CSVs into PySpark DataFrames.
- Register them as temporary SQL views.

## 🔍 Questions

1. **Display the total number of bookings per hotel.**
   - Expected Output: hotel_id | hotel_name | booking_count

2. **Find the average room rate charged by each hotel.**
   - Expected Output: hotel_id | hotel_name | avg_rate

3. **List all guests who have stayed more than once.**
   - Expected Output: guest_id | guest_name | booking_count > 1

4. **Which hotel had the longest average stay duration?**
   - Expected Output: hotel_id | hotel_name | avg_stay

5. **List the total revenue generated by each hotel.**
   - Expected Output: hotel_id | hotel_name | total_revenue

6. **List guests who booked rooms in 5-star hotels only.**
   - Expected Output: guest_id | guest_name

7. **Find hotels that were booked by guests from more than 3 different countries.**
   - Expected Output: hotel_id | hotel_name | unique_country_count

8. **Using SQL, show top 5 guests who spent the most across all bookings.**
   - Expected Output: guest_id | guest_name | total_spent

9. **Join guests and bookings and show guest names, their countries, and total nights stayed.**
   - Expected Output: guest_id | guest_name | country | total_nights

10. **Add a new column to bookings: `total_amount` = num_nights * room_rate. Show top 5 highest value bookings.**
    - Expected Output: booking_id | total_amount

11. **For each city, find the number of bookings and the average star rating.**
    - Expected Output: city | booking_count | avg_star_rating

12. **Use window functions to rank hotels by revenue in each city.**
    - Expected Output: city | hotel_id | hotel_name | total_revenue | rank

13. **Using ROW_NUMBER, find the most recent booking per guest.**
    - Expected Output: guest_id | guest_name | check_in_date

---

💡 Tip: Use joins and window functions where necessary. Practice both DataFrame and SQL API for solutions.